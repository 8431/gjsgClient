{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "window",
    "pkOnload",
    "self",
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "leftPlay",
    "Prefab",
    "rightPlay",
    "onLoad",
    "PkSocketEvents",
    "onloadPlay",
    "log",
    "openPkScoket",
    "init",
    "clickEvent",
    "event",
    "node",
    "target",
    "jn",
    "id",
    "skillname",
    "find",
    "active",
    "data",
    "pk",
    "selectStatus",
    "clickArrayRight",
    "clickArrayLeft",
    "onloadJnZhiling",
    "console",
    "clickRoleTool",
    "x",
    "y",
    "prefab",
    "leftp",
    "player1",
    "player2",
    "i",
    "length",
    "play",
    "instantiate",
    "addChild",
    "setPositionY",
    "setPositionX",
    "name",
    "role",
    "getComponent",
    "xue",
    "qixue",
    "qixue2",
    "jing",
    "jingli",
    "jingli2",
    "setXueAndJing",
    "buffLi",
    "buff",
    "getChildByName",
    "removeAllChildren",
    "k",
    "buffJs",
    "PrefabBuff",
    "getBuffPrefab",
    "buffIn",
    "buffDetail",
    "buffAni",
    "Animation",
    "spriteFrame",
    "j",
    "getSpriteFrame",
    "sprite",
    "Sprite",
    "setDead",
    "rightOne",
    "remove",
    "e",
    "attack",
    "num",
    "seqRight",
    "sequence",
    "moveTo",
    "p",
    "getPositionX",
    "getPositionY",
    "easing",
    "easeCubicActionOut",
    "runAction",
    "jineng",
    "content",
    "loader",
    "loadRes",
    "err",
    "getRoleMsg",
    "hPrefab",
    "height",
    "jnPrefab",
    "jnJs",
    "setJname",
    "on",
    "onloading",
    "pkyaostatus",
    "zidong",
    "setTimeout",
    "rightp",
    "Label",
    "string",
    "count",
    "timeCallback",
    "dt",
    "unschedule",
    "timeStatus",
    "schedule"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "\r\n\r\n\r\n\r\nwindow.pkOnload;\r\nvar self;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        leftPlay: cc.Prefab,\r\n        rightPlay: cc.Prefab,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        /**\r\n         * -212 59    -123    heigt=72   width 89\r\n         */\r\n        self = this;\r\n        window.pkOnload = this;\r\n        PkSocketEvents.onloadPlay = this.onloadPlay;\r\n        //this.init();\r\n        cc.log(\"pkOnload加载了。。。。。。。。\")\r\n        openPkScoket(true);\r\n        self.init();\r\n        /////////////////////////////////////////////////\r\n        // ajaxData(\"http://127.0.0.1:8080/Cocos2dAddPk/getYeGuaiData?level=10,15&name=侍卫群\", null, function (data) {\r\n        //     if (data.code != \"000\") {\r\n        //         showAlert(data.message);\r\n        //     } else {\r\n\r\n        //         let initData = JSON.parse(data.data);\r\n        //         onloadPkMsg(initData);\r\n        //         self.onloadPlay(-160, -165, 0);\r\n        //         self.onloadPlay(253, 205, 1);\r\n        //         onloadJn(true);\r\n\r\n\r\n        //         // self.init();\r\n        //     }\r\n\r\n        // });\r\n\r\n        //    / self.init();\r\n    },\r\n    clickEvent: function (event) {\r\n        var node = event.target;\r\n        var jn = node.id;\r\n        cc.log('技能名称:' + node.id.skillname);\r\n        cc.find(\"Canvas/jineng\").active = false;\r\n        var data = null;\r\n        //有些技能可以对自己或者队友释放\r\n        switch (node.id.skillname) {\r\n            case \"气冲斗牛\": {\r\n                pk.selectStatus = 2000;\r\n                data = pk.clickArrayRight[0]\r\n                break;\r\n            }\r\n            default: {\r\n                pk.selectStatus = 3000;\r\n                data = pk.clickArrayLeft[0];\r\n                break;\r\n            }\r\n        }\r\n\r\n\r\n        onloadJnZhiling(false);\r\n        console.log(\"选择指令完成\")\r\n\r\n        //模拟点击第一个人物按钮效果\r\n        clickRoleTool(data, node.id.skillname);\r\n\r\n    },\r\n\r\n    /**right   w=89 h=59\r\n     * x=253 \r\n     * left \r\n     * x=-212   -265   305\r\n     */\r\n\r\n    onloadPlay: function (x, y, prefab) {\r\n        cc.log(\"onloadPlay被调用了------------------\")\r\n        //初始化加载界面，所有角色都不可以点击\r\n        pk.selectStatus = \"001\";\r\n        var leftp;\r\n        if (prefab == 0) {\r\n            prefab = self.leftPlay;\r\n            cc.log(pk.player1)\r\n            leftp = pk.player1\r\n        } else {\r\n            prefab = self.rightPlay;\r\n            leftp = pk.player2;\r\n        }\r\n        for (let i = 0; i < leftp.length; i++) {\r\n            let play = cc.instantiate(prefab);\r\n            self.node.addChild(play);\r\n            play.setPositionY(59 - i * 72);\r\n            if (leftp.length == 1) {\r\n                play.setPositionY(0);\r\n                play.setPositionX(x);\r\n            } else {\r\n                switch (i) {\r\n                    case 0:\r\n                    case 2: {\r\n\r\n                        play.setPositionX(x - 89);\r\n                        break;\r\n                    }\r\n                    case 1:\r\n                    case 3: {\r\n                        play.setPositionX(x);\r\n\r\n                        break;\r\n                    }\r\n\r\n                }\r\n            }\r\n\r\n            play.name = leftp[i].id;\r\n            var role = play.getComponent(\"role\");\r\n\r\n            var xue = leftp[i].qixue / leftp[i].qixue2;\r\n            var jing = leftp[i].jingli / leftp[i].jingli2;\r\n            role.setXueAndJing(xue, jing);\r\n\r\n            //buff\r\n            try {\r\n                var buffLi = leftp[i].buff;\r\n                if (buffLi != null && buffLi.length > 0) {\r\n                    var buff = play.getChildByName(\"buff\");\r\n                    buff.removeAllChildren();\r\n                    for (let k = 0; k < buffLi.length; k++) {\r\n                        cc.log(\"-kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk\")\r\n                        var buffJs = buff.getComponent(\"buff\");\r\n                        var PrefabBuff = buffJs.getBuffPrefab();\r\n                        var buffIn = cc.instantiate(PrefabBuff);\r\n                        var buffDetail = buffIn.getComponent(\"buffDetail\");\r\n                        var buffAni = buffDetail.getComponent(cc.Animation);\r\n                        var spriteFrame;\r\n                        for (var j in buffLi[k]) {\r\n                            spriteFrame = buffDetail.getSpriteFrame(j);\r\n                        }\r\n                        //spriteFrame存在时加入\r\n                        if (typeof (spriteFrame) != 'undefined') {\r\n                            var sprite = buffIn.getComponent(cc.Sprite);\r\n                            sprite.spriteFrame = spriteFrame;\r\n                            buff.addChild(buffIn);\r\n                        }\r\n\r\n\r\n                    }\r\n                }\r\n                //气血为0\r\n                if (leftp[i].qixue <= 0) {\r\n                    role.setDead();\r\n                    if (leftp[i].id != pk.rightOne) {\r\n                        pk.clickArrayLeft.remove(leftp[i].id);\r\n                    }\r\n\r\n                }\r\n\r\n                // if (leftp[i].buffType != null) {\r\n                //     var buff = play.getChildByName(\"buff\");\r\n                //     var buffJs = buff.getComponent(\"buff\");\r\n                //     var PrefabBuff = buffJs.getBuffPrefab();\r\n                //     var buffIn = cc.instantiate(PrefabBuff);\r\n                //     var buffDetail = buffIn.getComponent(\"buffDetail\");\r\n                //     var buffAni = buffDetail.getComponent(cc.Animation);\r\n                //     var spriteFrame = buffDetail.getSpriteFrame(leftp[i].buffTypeKey);\r\n                //     var sprite = buffIn.getComponent(cc.Sprite);\r\n                //     sprite.spriteFrame = spriteFrame;\r\n                //     buff.addChild(buffIn);\r\n                // }\r\n            } catch (e) {\r\n                cc.log(\"加载buff失败：\" + e);\r\n\r\n            }\r\n\r\n\r\n\r\n        }\r\n\r\n    },\r\n    /**\r\n     * 发送指令状态标识\r\n     */\r\n\r\n    /**\r\n    * 指令函数\r\n    * param e 事件对象\r\n    * param num 区分按钮类型\r\n    * param type 区分攻击类型\r\n    * param status 区分左右角色\r\n    */\r\n    attack: function (e, num) {\r\n        var name;\r\n        try {\r\n            switch (num) {\r\n                //攻击指令\r\n                case 'gj': {\r\n                    onloadJnZhiling(false);\r\n                    console.log(\"选择指令完成\")\r\n                    pk.selectStatus = 3000;\r\n\r\n                    //模拟点击第一个人物按钮效果\r\n                    clickRoleTool(pk.clickArrayLeft[0], \"普通攻击\");\r\n\r\n\r\n\r\n                    break;\r\n                }\r\n                //攻击指令\r\n                case 'fy': {\r\n                    //模拟点击第一个人物按钮效果\r\n                    clickRoleTool(pk.clickArrayLeft[0], \"防御\");\r\n                    break;\r\n                }\r\n                case 'tp': {\r\n                    cc.log(\"逃跑\");\r\n                    cc.find(\"Canvas/zhiling\").active = false;\r\n                    let play = cc.find(\"Canvas/background/\" + pk.clickArrayRight[0])\r\n                    //获取边框到中心的距离，即得到两边框的坐标。注意：因为时序问题，必须要canvas的宽度来计算\r\n                    let seqRight = cc.sequence(cc.moveTo(2, cc.p(play.getPositionX() + 500, play.getPositionY())).easing(cc.easeCubicActionOut(1)));\r\n                    play.runAction(seqRight);\r\n                    break;\r\n                }\r\n                //技能指令\r\n                case 'jn': {\r\n                    cc.log(\"技能\")\r\n                    cc.find(\"Canvas/zhiling\").active = false;\r\n                    cc.log(\"初始化技能列表\")\r\n                    var jineng = cc.find(\"Canvas/jineng\");\r\n                    jineng.active = true;\r\n                    let content = cc.find(\"Canvas/jineng/detail/scrollview/view/content\")\r\n                    cc.loader.loadRes('pk/jnButton', cc.Prefab, function (err, prefab) {\r\n                        if (!err) {\r\n                            var p = getRoleMsg(pk.clickArrayRight[0], pk.player2)\r\n                            var jn = p.jineng;\r\n                            content.removeAllChildren();\r\n                            var hPrefab = cc.instantiate(prefab);\r\n                            content.height = jn.length * (hPrefab.height + 5);\r\n                            for (let i = 0; i < jn.length; i++) {\r\n                                var jnPrefab = cc.instantiate(prefab);\r\n                                var jnJs = jnPrefab.getComponent(\"jnName\");\r\n                                jnJs.setJname(jn[i].skillname);\r\n                                jnPrefab.on('click', self.clickEvent, self);\r\n                                jnPrefab.id = jn[i];\r\n                                content.addChild(jnPrefab);\r\n                            }\r\n                        }\r\n                    });\r\n\r\n\r\n                    break;\r\n                }\r\n                //物品\r\n                case 'wp': {\r\n                    cc.log(\"物品\")\r\n                    cc.find(\"Canvas/zhiling\").active = false;\r\n                    cc.find(\"Canvas/wupin\").active = true;\r\n                    cc.find(\"Canvas/jineng\").active = false;\r\n                    cc.log(\"物品列表\")\r\n                    cc.find(\"Canvas/wupin/detail/scrollview/view/content\").getComponent('pkWuPin').onloading();\r\n                    pk.pkyaostatus = \"1\";\r\n\r\n                    break;\r\n                }\r\n                //招将\r\n                case 'zj': {\r\n                    cc.log(\"物品\")\r\n                    cc.find(\"Canvas/zhiling\").active = false;\r\n                    cc.find(\"Canvas/zhaojiang\").active = true;\r\n                    cc.find(\"Canvas/jineng\").active = false;\r\n                    cc.log(\"物品列表\")\r\n\r\n\r\n\r\n\r\n                    break;\r\n                }\r\n            }\r\n\r\n        } catch (e) {\r\n            cc.log('加载技能列表异常:' + e)\r\n        }\r\n\r\n\r\n    },\r\n    zidong: function () {\r\n        var num = 1;\r\n        for (var i = 0; i < pk.clickArrayRight.length; i++) {\r\n            setTimeout(() => {\r\n                self.attack(this, \"gj\");\r\n\r\n            }, 200 * num);\r\n            num++;\r\n            setTimeout(() => {\r\n                clickRoleTool(pk.clickArrayLeft[0], \"普通攻击\");\r\n            }, 200 * num);\r\n            num++;\r\n\r\n        }\r\n    },\r\n    init: function () {\r\n        try {\r\n\r\n            cc.find(\"Canvas/roleDetail\").active = false;\r\n            cc.find(\"Canvas/jineng\").active = false;\r\n            cc.find(\"Canvas/wupin\").active = false;\r\n            cc.find(\"Canvas/zhaojiang\").active = false;\r\n            cc.find(\"Canvas/end\").active = false;\r\n            cc.find(\"Canvas/zhiling\").active = true;\r\n            var leftp = pk.player1;\r\n            var rightp = pk.player2;\r\n            self.node.removeAllChildren();\r\n            cc.find(\"Canvas/vs/left\").getComponent(cc.Label).string = leftp[0].name\r\n            cc.find(\"Canvas/vs/right\").getComponent(cc.Label).string = rightp[0].name\r\n            cc.find(\"Canvas/time/name\").getComponent(cc.Label).string = rightp[0].name\r\n            //倒计时\r\n            var count = 60;\r\n            var timeCallback = function (dt) {\r\n                if (count === 0) {\r\n                    // 在第六次执行回调时取消这个计时器\r\n                    this.unschedule(timeCallback);\r\n                    this.zidong();\r\n                } else {\r\n                    cc.find(\"Canvas/time\").active = true;\r\n                    cc.find(\"Canvas/time/time\").getComponent(cc.Label).string = \"出招(\" + count + \")\";\r\n                    count--;\r\n                }\r\n                if (pk.timeStatus === 8000) {\r\n                    // 在第六次执行回调时取消这个计时器\r\n                    this.unschedule(timeCallback);\r\n                    cc.find(\"Canvas/time\").active = false;\r\n\r\n                }\r\n            }\r\n\r\n            this.schedule(timeCallback, 1);\r\n        } catch (e) {\r\n            cc.log(e)\r\n        }\r\n\r\n\r\n    },\r\n\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n\r\n\r\n//  window.pkWs= new WebSocket(ws://127.0.0.1:8080/pkServer');\r\n//         pkWs.onopen = function (event) {\r\n//             // 发送一个初始化消息\r\n//             // 发送一个初始化消息\r\n//             var jsonData = {\r\n//                 type: \"pkWait\",\r\n//                 pkType: \"1001\",\r\n//                 jsonData: {\r\n//                     roleA: \"1000\",\r\n//                     roleB: \"1000\",\r\n//                     guaiData: {\r\n//                         \"level\": \"115,120\",\r\n//                         \"name\": \"藤甲兵群\"\r\n//                     }\r\n\r\n//                 },\r\n//             }\r\n//             pkWs.send(JSON.stringify(jsonData));\r\n//         }\r\n//         // 监听消息\r\n//         pkWs.onmessage = function (event) {\r\n//             console.log('Client notified socket has closed', JSON.stringify(event.data));\r\n//             var returnJsonData =JSON.parse(event.data);\r\n//             cc.log(returnJsonData)\r\n//             pk.uuid = returnJsonData[0];\r\n//             pk.player1 = returnJsonData[1];\r\n//           //  pk.player2 = returnJsonData;\r\n//             pk.leftPlay = [];\r\n//               pk.clickArrayLeft=[];\r\n//           //  pk.rightPlay = [];\r\n//             for (var i = 0; i <  pk.player1.length; i++) {\r\n//                 cc.log( pk.player1[i].id);\r\n//                  pk.leftPlay.push( pk.player1[i].id);\r\n//                  pk.clickArrayLeft.push( pk.player1[i].id);\r\n//               //  pk.rightPlay.push(returnJsonData[i].id)\r\n//             }\r\n//             self.onloadPlay( pk.player1, -160, -165,  self.leftPlay, self);\r\n//             self.onloadPlay( pk.player2, 253, 205,  self.rightPlay, self);\r\n//             onloadJn(true);\r\n//         };"
  ]
}