{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "self",
    "playStatus",
    "msg",
    "pk",
    "msgJson",
    "TweenLite",
    "require",
    "module",
    "exports",
    "getpkStateMachine",
    "pkStateMachine",
    "StateMachine",
    "data",
    "battle",
    "transitions",
    "name",
    "from",
    "to",
    "methods",
    "onStart",
    "cc",
    "log",
    "player1",
    "attackType",
    "player2",
    "battleData",
    "Qx",
    "Qx2",
    "e",
    "console",
    "setTimeout",
    "onToShifa",
    "length",
    "pkstatus",
    "find",
    "active",
    "initType",
    "jsonData",
    "tempMsg",
    "onloadPkMsg",
    "selectStatus",
    "timeStatus",
    "window",
    "pkOnload",
    "init",
    "PkSocketEvents",
    "onloadPlay",
    "onloadJn",
    "getComponent",
    "Label",
    "string",
    "body",
    "shifAnim",
    "getChildByName",
    "Animation",
    "playbloodClose",
    "buffClose",
    "playAnim",
    "onToMoveBackGround",
    "jnName",
    "type",
    "onToSkill",
    "background",
    "x",
    "rolePosition",
    "moveTo",
    "jnAnim",
    "standAnim",
    "key",
    "playGongId",
    "playShouId",
    "playGong",
    "playShou",
    "playGongX",
    "playGongY",
    "y",
    "onToKouXue",
    "onFinshed",
    "color",
    "Color",
    "num",
    "i",
    "jnDan",
    "playAnimArr",
    "onToReturnBackGround",
    "play",
    "qx",
    "shouji",
    "kouxue",
    "dead",
    "wz",
    "qx2",
    "scaleX",
    "deadAnim",
    "onEnd",
    "arr",
    "id",
    "re",
    "m",
    "parseInt",
    "qixue",
    "buffType",
    "buff",
    "anim",
    "callback",
    "on",
    "position",
    "ease",
    "Power2",
    "easeOut",
    "onComplete",
    "left",
    "leftPlay",
    "right",
    "rightPlay",
    "opacity",
    "children",
    "removeAllChildren",
    "role",
    "stop",
    "playJs",
    "Class",
    "extends",
    "Component",
    "properties",
    "head",
    "Sprite",
    "foot",
    "attack",
    "Node",
    "button",
    "Button",
    "roleDeath",
    "label",
    "death",
    "shifa",
    "py",
    "stateMachine",
    "toStart",
    "onLoad",
    "attackHide",
    "attackShow",
    "getRoleMsg",
    "p",
    "play1",
    "playerClickEvent",
    "event",
    "parent",
    "clickStatus",
    "node",
    "target",
    "roleDetail",
    "roleDetailJs",
    "getPkRoleMsg",
    "setAttackName",
    "jn",
    "setType",
    "setXue",
    "setJing",
    "jingli",
    "setsu",
    "status",
    "attacked",
    "push",
    "shift",
    "back",
    "sccen",
    "director",
    "getScene",
    "child"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "\r\n\r\n\r\nvar self;\r\nvar playStatus = 0;\r\nvar msg = pk.msg;\r\nvar msgJson;\r\nvar TweenLite = require('TweenLite');\r\n/**\r\n * PK动画播放有限状态机\r\n */\r\nmodule.exports = function getpkStateMachine() {\r\n\r\n\r\n    this.pkStateMachine = new StateMachine({\r\n        data: {\r\n            battle: null,\r\n        },\r\n        transitions: [\r\n            { name: 'toStart', from: 'none', to: 'start' },\r\n            { name: 'toShifa', from: 'start', to: 'shifa' },\r\n            { name: 'toMoveBackGround', from: 'shifa', to: 'backgorund' },\r\n            { name: 'toSkill', from: 'backgorund', to: 'skill' },\r\n            { name: 'toKouXue', from: 'skill', to: 'kouxue' },\r\n            { name: 'toReturnBackGround', from: 'kouxue', to: 'moveBack' },\r\n            { name: 'finshed', from: 'moveBack', to: 'end' },\r\n            { name: 'end', from: 'end', to: 'start' }\r\n\r\n        ],\r\n        methods: {\r\n            onStart() {\r\n                msg = pk.msg;\r\n                msgJson = msg[playStatus];\r\n                try {\r\n                    cc.log(msgJson.player1 + \"使用了【\" + msgJson.attackType.name + \"】造成\" + msgJson.player2[0] + \"：\" + msgJson.battleData[msgJson.player2[0]].Qx + \"被攻击者剩余：\" + msgJson.battleData[msgJson.player2[0]].Qx2);\r\n                } catch (e) {\r\n\r\n                }\r\n\r\n                console.log(\"onStart\")\r\n                setTimeout(() => {\r\n                    this.onToShifa();\r\n                }, 100);\r\n            },\r\n            onToShifa() {\r\n                if (playStatus >= pk.msg.length) {\r\n                    playStatus=0;\r\n                    if (pk.pkstatus != \"6000\" && pk.pkstatus != \"\") {\r\n                        cc.log(\"战斗结束\")\r\n                        cc.find(\"Canvas/end\").active = true;\r\n                        pk.msg = [];\r\n                        pk.pkstatus = \"\";\r\n                         //重置\r\n                        pk.initType=\"init\";\r\n                        pk.player1 = {}\r\n                        pk.player2 = {}\r\n                        return;\r\n                    }\r\n                    if (pk.initType != \"init\") {\r\n                        //重置\r\n                        pk.initType=\"init\";\r\n                \r\n                        var jsonData = pk.tempMsg;\r\n                        //重新加载主界面数据----2018-1-21修复重复加载rightPlay问题\r\n                        onloadPkMsg(jsonData);\r\n                        pk.selectStatus = 2000;\r\n                        pk.timeStatus = 0;//开启倒计时\r\n                        pk.msg = [];//初始化数据\r\n                        playStatus = 0;\r\n                        cc.log(pk)\r\n                        window.pkOnload.init();\r\n                        PkSocketEvents.onloadPlay(-160, -165, 0);\r\n                        PkSocketEvents.onloadPlay(253, 205, 1);\r\n                        onloadJn(true);\r\n                    }\r\n\r\n                } else {\r\n                    cc.find(\"Canvas/name/attackType\").getComponent(cc.Label).string = msgJson.attackType.name;\r\n                    console.log(\"施法。。。\" + msgJson.player1)\r\n                    var body = cc.find(\"Canvas/background/\" + msgJson.player1 + \"/play/role/body\");\r\n                    var shifAnim = body.getChildByName(\"shifa\").getComponent(cc.Animation);\r\n\r\n                    //关闭血条显示\r\n                    playbloodClose(0);\r\n                    //关闭所有人物buff显示\r\n                    buffClose();\r\n\r\n                    //对自身队友释放技能，场景不移动\r\n                    let self = this;\r\n                    setTimeout(() => {\r\n                        playAnim(shifAnim, function () {\r\n                            self.onToMoveBackGround();\r\n                        })\r\n                    }, 100);\r\n                }\r\n            },\r\n            onToMoveBackGround() {\r\n                console.log(\"背景移动开始\")\r\n                var jnName = msgJson.attackType.type;\r\n                if (jnName == \"jnzhanpugong\" || jnName == \"usryao\" || jnName == \"jlbz\") {\r\n                    setTimeout(() => { this.onToSkill(); }, 100);\r\n                } else {\r\n                    setTimeout(() => {\r\n                        var background = cc.find(\"Canvas/background\");\r\n\r\n                        var x = msgJson.attackType.rolePosition == 'left' ? -200 : 200;\r\n                        if (msgJson.attackType.rolePosition == \"self\") {\r\n                            x = -200;\r\n                        }\r\n                        let self = this;\r\n                        moveTo(background, x, 137, function () {\r\n                            self.onToSkill();\r\n                        })\r\n                    }, 100);\r\n                }\r\n\r\n            },\r\n\r\n            onToSkill() {\r\n                var background = cc.find(\"Canvas/jn\");\r\n                var jnAnim = null;\r\n                //停止站立\r\n                standAnim(msgJson.player2, false)\r\n                var jnName = msgJson.attackType.type;\r\n                var key = false;\r\n\r\n                switch (jnName) {\r\n                    case \"jnzhanpugong\": {\r\n                        var playGongId = msgJson.player1;\r\n                        var playShouId = msgJson.player2[0];\r\n                        var playGong = cc.find(\"Canvas/background/\" + playGongId);\r\n                        var playShou = cc.find(\"Canvas/background/\" + playShouId);\r\n                        var playGongX = playGong.x;\r\n                        var playGongY = playGong.y;\r\n                        let self = this;\r\n                        moveTo(playGong, playShou.x, playShou.y, function () {\r\n                            self.onToKouXue();\r\n                            moveTo(playGong, playGongX, playGongY, function () {\r\n                                setTimeout(() => {\r\n                                    self.onFinshed();\r\n                                }, 1000)\r\n\r\n                            });\r\n                        });\r\n\r\n                        break;\r\n                    }\r\n                    case \"wugujidu\": {\r\n\r\n                        cc.find(\"Canvas/background\").color = new cc.Color(255, 255, 255);\r\n                        jnAnim = background.getComponent(cc.Animation);\r\n                        key = true;\r\n                        break;\r\n                    }\r\n                    case \"jlbz\": {\r\n                        let self = this;\r\n                        self.onFinshed();\r\n\r\n                        key = false;\r\n                        break;\r\n                    }\r\n                    case \"wei\":\r\n                    case \"luan\":\r\n                    case \"feng\":\r\n                    case \"usryao\":\r\n                    case \"qichong\": {\r\n                        var playShouId = msgJson.player2;\r\n                        var num = 0;\r\n                        let self = this;\r\n                        for (let i = 0; i < playShouId.length; i++) {\r\n                            setTimeout(() => {\r\n                                var jnDan = cc.find(\"Canvas/background/\" + playShouId[i] + \"/jnDan\");\r\n                                cc.log(\"Canvas/background/\" + playShouId[i] + \"/jnDan\")\r\n                                jnAnim = jnDan.getComponent(cc.Animation);\r\n\r\n                                playAnimArr(jnAnim, jnName, function () {\r\n                                    msg = pk.msg;\r\n                                    num++;\r\n                                    if (num == playShouId.length - 1) {\r\n                                        self.onToReturnBackGround();\r\n                                    }\r\n                                    self.onToReturnBackGround();\r\n                                    console.log(jnName + \"技能释放完毕\")\r\n                                })\r\n                                self.onToKouXue(jnName);\r\n\r\n\r\n\r\n                            }, 100);\r\n\r\n\r\n                        }\r\n                        // setTimeout(() => {\r\n                        //    pkStateMachine.onToReturnBackGround();\r\n                        // }, 100 * (playShouId.length+1));\r\n                        key = false;\r\n                        break;\r\n\r\n                    }\r\n\r\n                    case \"lei\":\r\n                    case \"lipi\":\r\n                    case \"sheming\":\r\n                        {\r\n                            cc.find(\"Canvas/background\").color = new cc.Color(0, 0, 0);\r\n                            var playShouId = msgJson.player2[0];\r\n                            var jnDan = cc.find(\"Canvas/background/\" + playShouId + \"/jnDan\");\r\n                            jnAnim = jnDan.getComponent(cc.Animation);\r\n                            key = true;\r\n                            break;\r\n                        }\r\n\r\n                    default: {\r\n                        cc.find(\"Canvas/background\").color = new cc.Color(0, 0, 0);\r\n                        jnAnim = background.getComponent(cc.Animation);\r\n                        key = true;\r\n                        break;\r\n\r\n\r\n                    }\r\n                }\r\n                if (key) {\r\n                    let self = this;\r\n                    setTimeout(() => {\r\n                        playAnimArr(jnAnim, jnName, function () {\r\n                            // pkStateMachine.onToKouXue();\r\n                            console.log(\"技能释放完毕\")\r\n                            self.onToReturnBackGround();\r\n\r\n                        })\r\n                        self.onToKouXue();\r\n                    }, 100);\r\n\r\n                }\r\n\r\n\r\n\r\n            },\r\n            onToKouXue(jnName) {\r\n                //被攻击着\r\n                let play = msgJson.player2;\r\n                let battleData = msgJson.battleData;\r\n                let attackType = msgJson.attackType;\r\n\r\n                for (let i = 0; i < play.length; i++) {\r\n                    // var re = kouxue(pk.player1, play[i], battleData[play[i]],attackType);\r\n                    // if (re) {\r\n                    //     kouxue(pk.player2, play[i], battleData[play[i]],attackType);\r\n                    // }\r\n                    setTimeout(() => {\r\n                        let qx = battleData[play[i]].Qx;\r\n                        //播放扣血，或者种了BUFF动画，buff动画根据技能名称选择\r\n                        let shouji = cc.find(\"Canvas/background/\" + play[i]).getComponent(cc.Animation);\r\n                        let kouxue = cc.find(\"Canvas/background/\" + play[i] + \"/play/kouxue\");\r\n                        kouxue.getComponent(cc.Label).string = qx;\r\n                        let dead = cc.find(\"Canvas/background/\" + play[i] + \"/dead\");\r\n                        //  let kouxue = cc.find(\"Canvas/background/\" + play[i] + \"/play/kouxue\");\r\n                        if (jnName == \"usryao\") {\r\n                            cc.find(\"Canvas/background/\" + play[i] + \"/play\").active = true;\r\n                            //  kouxue.color = new cc.Color(\"#16F10D\");\r\n                            dead.active = false;\r\n                        } else {\r\n                            //  kouxue.color = new cc.Color(\"#000000\");\r\n                        }\r\n                        if (qx == 0) {\r\n                            kouxue.getComponent(cc.Label).string = \"\";\r\n                            let wz = cc.find(\"Canvas/background/\" + play[i] + \"/play/wz\").getComponent(cc.Animation);;\r\n                            playAnim(wz);\r\n                        }\r\n                        playAnim(shouji, function () {\r\n\r\n                            let qx2 = battleData[play[i]].Qx2;\r\n                            cc.find(\"Canvas/background/\" + play[i] + \"/play/kouxue\").getComponent(cc.Label).string = \"\";\r\n                            if (qx2 == 0) {\r\n                                //播放死亡动画\r\n                                dead.scaleX = -1;\r\n                                cc.find(\"Canvas/background/\" + play[i] + \"/play\").active = false;\r\n                                let deadAnim = dead.getComponent(cc.Animation);\r\n                                playAnim(deadAnim, null);\r\n                            }\r\n\r\n\r\n                        });\r\n\r\n\r\n\r\n                    }, 200);\r\n\r\n\r\n\r\n\r\n                }\r\n\r\n            },\r\n            onToReturnBackGround() {\r\n                console.log(\"onMoveBack----\");\r\n                var background = cc.find(\"Canvas/background\")\r\n                background.color = new cc.Color(240, 240, 240);\r\n                let self = this;\r\n                setTimeout(() => {\r\n                    moveTo(background, -20, 137, function () {\r\n                        self.onFinshed();\r\n                    })\r\n\r\n                }, 100);\r\n\r\n            },\r\n            onFinshed() {\r\n                console.log(\"onFinshed----\");\r\n                cc.find(\"Canvas/name/attackType\").getComponent(cc.Label).string = \"\";\r\n                this.onEnd();\r\n            },\r\n            onEnd() {\r\n                playStatus++;\r\n                this.onStart();\r\n                console.log(\"end----\");\r\n            },\r\n        }\r\n    });\r\n    //return pkStateMachine;\r\n\r\n}\r\n\r\nfunction kouxue(arr, id, battleData, attackType) {\r\n    var qx = battleData.Qx;\r\n    var re = true;\r\n    cc.log(id)\r\n    for (let m = 0; m < arr.length; m++) {\r\n        cc.log(\"------------------------\");\r\n        cc.log(arr[m].id)\r\n        if (arr[m].id == id) {\r\n            try {\r\n                qx = parseInt(qx);\r\n                arr[m].qixue = battleData.Qx2;\r\n                re = false;\r\n                cc.log(arr);\r\n                var buffType = battleData.buff;\r\n                if (buffType != null && typeof (buffType) != 'undefined') {\r\n                    arr[m]['battleData'] = battleData;\r\n                }\r\n            } catch (e) {\r\n                cc.log(\"buff加载异常:\" + e)\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n    cc.log(pk)\r\n    return re;\r\n\r\n}\r\nfunction playAnim(anim, callback) {\r\n    anim.play();\r\n    if (callback) {\r\n        anim.on('finished', callback);\r\n    }\r\n}\r\nfunction playAnimArr(anim, name, callback) {\r\n    anim.play(name);\r\n    if (callback) {\r\n        anim.on('finished', callback);\r\n    }\r\n}\r\nfunction moveTo(position, x, y, callback) {\r\n\r\n\r\n    TweenLite.to(position, 0.5, {\r\n        x: x,\r\n        y: y,\r\n        ease: Power2.easeOut,\r\n        onComplete: callback\r\n    });\r\n\r\n}\r\n/**\r\n * 玩家血条显示开关\r\n */\r\nfunction playbloodClose(num) {\r\n    var left = pk.leftPlay;\r\n    var right = pk.rightPlay;\r\n    for (let i = 0; i < left.length; i++) {\r\n        cc.find(\"Canvas/background/\" + left[i] + \"/play/status\").opacity = num;\r\n\r\n\r\n    }\r\n    for (let i = 0; i < right.length; i++) {\r\n        cc.find(\"Canvas/background/\" + right[i] + \"/play/status\").opacity = num;\r\n\r\n    }\r\n\r\n}\r\n/**\r\n * 关闭玩家buff\r\n */\r\nfunction buffClose() {\r\n    var background = cc.find(\"Canvas/background\");\r\n    var children = background.children;\r\n    for (var i = 0; i < children.length; ++i) {\r\n        try {\r\n            let buff = children[i].getChildByName(\"buff\");\r\n            buff.removeAllChildren();\r\n        } catch (e) {\r\n            cc.log(e)\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n/**\r\n * 站立动画控制开关\r\n */\r\nfunction standAnim(arr, key) {\r\n\r\n    for (let i = 0; i < arr.length; i++) {\r\n        var role = cc.find(\"Canvas/background/\" + arr[i] + \"/play/role\");\r\n        if (key) {\r\n            role.getComponent(cc.Animation).play();\r\n        } else {\r\n            role.getComponent(cc.Animation).stop();\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\nvar playJs = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        head: cc.Sprite,\r\n        body: cc.Sprite,\r\n        foot: cc.Sprite,\r\n        attack: cc.Node,\r\n        button: cc.Button,\r\n        roleDeath: cc.Node,\r\n        label: cc.Node,\r\n    },\r\n    death: function () {\r\n        this.roleDeath.active = true;\r\n\r\n\r\n\r\n    },\r\n    shifa: function () {\r\n        var playJs = require(\"playerItem\");\r\n        var py = new playJs();\r\n        var stateMachine = py.pkStateMachine;\r\n        stateMachine.toStart();\r\n\r\n    },\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        self = this;\r\n\r\n\r\n        // var flipYAction = cc.flipX(true);\r\n        // var actionBy = cc.moveTo(0.5, cc.p(130,698));\r\n        //    this.node.runAction(flipYAction);\r\n\r\n        //  this.node.runAction(actionBy);\r\n\r\n        //    var y= this.node.getPositionY();\r\n        //       var x= this.node.getPositionX();\r\n        //       var height=y+10;\r\n        //     var seq = cc.repeatForever(cc.moveTo(x, cc.p(0,y+10)).easing(cc.easeCubicActionOut(1)));\r\n        //     if(height==this.node.getPositionY())\r\n        //       var seq = cc.repeatForever(cc.moveTo(x, cc.p(0,y-10)).easing(cc.easeCubicActionOut(1)));\r\n        //     this.body.node.runAction(seq);\r\n\r\n        //         cc.log(\"---height:\"+this.node.getPositionY())\r\n\r\n\r\n    },\r\n    attackHide: function () {\r\n        this.attack.active = false;\r\n\r\n    },\r\n\r\n    attackShow: function () {\r\n        this.attack.active = true;\r\n\r\n    },\r\n    /**\r\n     * 遍历数组返回角色信息----\r\n     */\r\n    getRoleMsg: function (id) {\r\n        try {\r\n            var p = pk.play1;\r\n            for (var i in p) {\r\n                if (id == p[i].id) {\r\n                    return p[i];\r\n                }\r\n            }\r\n        } catch (e) {\r\n\r\n        }\r\n\r\n\r\n    },\r\n    playerClickEvent: function (event) {\r\n        cc.log('人物点击时间触发')\r\n        var parent;\r\n        var msg;\r\n        var left;\r\n        try {\r\n            if (pk.clickStatus) {\r\n                var node = event.target;\r\n\r\n                if (typeof (node) == 'undefined') {\r\n                    cc.log('------------------')\r\n                    parent = event;\r\n                } else {\r\n                    parent = node.parent;\r\n                    cc.log('-------+++++-----------')\r\n                }\r\n\r\n\r\n                var roleDetail = cc.find(\"Canvas/roleDetail\");\r\n                var roleDetailJs = roleDetail.getComponent(\"roledetail\");\r\n                msg = getPkRoleMsg(parent.name, 1);\r\n                left = pk.leftPlay;\r\n                if (typeof (msg) == 'undefined') {\r\n                    msg = getPkRoleMsg(parent.name, 2);\r\n                    left = pk.rightPlay;\r\n                }\r\n\r\n                roleDetailJs.setAttackName(pk.jn);\r\n                roleDetailJs.setType(msg.name);\r\n                roleDetailJs.setXue(\"血:\" + msg.qixue);\r\n                roleDetailJs.setJing(\"精:\" + msg.jingli);\r\n                roleDetailJs.setsu(\"速度第八\");\r\n                cc.log(pk.status)\r\n                if (pk.status == parent.name) {\r\n                    cc.log(\"攻击指令完成:\" + pk.rightPlay[0] + \"使用【\" + pk.jn + \"】攻击了\" + parent.name);\r\n                    //指令数组\r\n                    pk.attacked.push({ 'attack': pk.rightPlay[0], 'attacked': parent.name, 'attackType': pk.jn });\r\n\r\n                    pk.rightPlay.shift();\r\n                    if (pk.rightPlay.length == 0) {\r\n                        //右方攻击指令全部完成\r\n                        cc.log(\"发送攻击指令给服务器:\" + pk.attacked.length)\r\n\r\n                    }\r\n                    this.back();\r\n                    parent.getComponent(\"playerItem\").attackHide();\r\n                    pk.clickStatus = false;\r\n                    pk.status = null;\r\n                    pk.jn = '普通攻击'\r\n\r\n\r\n                } else {\r\n                    pk.status = parent.name;\r\n                    parent.getComponent(\"playerItem\").attackShow();\r\n                    var sccen = cc.director.getScene()\r\n                    for (var i in left) {\r\n                        if (left[i] != parent.name) {\r\n                            var child = sccen.getChildByName(left[i]);\r\n                            child.getComponent(\"playerItem\").attackHide();\r\n                        }\r\n\r\n                    }\r\n                }\r\n\r\n\r\n\r\n\r\n\r\n            }\r\n\r\n\r\n        } catch (e) {\r\n\r\n            cc.log(e)\r\n\r\n        }\r\n\r\n\r\n    },\r\n\r\n    back: function () {\r\n        var right = pk.rightPlay;\r\n        if (typeof (right[0]) == 'undefined' || right[0] == null || right[0] == '') {\r\n            cc.find(\"Canvas/zhiling\").active = false;\r\n            cc.find(\"Canvas/roleDetail\").active = false;\r\n        } else {\r\n            cc.find(\"Canvas/zhiling\").active = true;\r\n            cc.find(\"Canvas/roleDetail\").active = false;\r\n            for (var m in right) {\r\n                var child = cc.director.getScene().getChildByName(right[m]);\r\n                if (m == 0) {\r\n                    child.getComponent(\"playerItem\").attackShow();\r\n                } else {\r\n                    child.getComponent(\"playerItem\").attackHide();\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n\r\n});\r\n\r\n"
  ]
}